<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<bns:Component xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bns="http://api.platform.boomi.com/" folderFullPath="Presales Demo/#GTO SHARED SERVICES/Mongo Operations in Boomi/Use Case 3" componentId="31a52c32-99f1-4b53-8388-da5288f8c36f" version="1" name="XSLT: Prepare Report" type="xslt" createdDate="2020-08-24T04:50:17Z" createdBy="kundan.gupta@dell.com" modifiedDate="2020-08-24T04:50:17Z" modifiedBy="kundan.gupta@dell.com" deleted="false" currentVersion="true" folderName="Use Case 3" folderId="RjozNTAwMTA1" copiedFromComponentId="0ac7e24b-7321-454b-86fd-2a21e07a546a" copiedFromComponentVersion="1">
  <bns:encryptedValues/>
  <bns:description/>
  <bns:object>
    <Xslt xmlns="">
      <stylesheet>&lt;xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:boomi="http://boomi.com/custom-function"&gt;&#13;
	&lt;xsl:template match="/"&gt;&#13;
		&lt;html&gt;&#13;
			&lt;body&gt;&#13;
				&lt;xsl:variable name="documentCount" select="boomi:get-ddp('DDP_DocumentCount')"/&gt;&#13;
				&lt;p style="text-align:left;"&gt;Hi All,&lt;/p&gt;&#13;
				&lt;p style="text-align:left;"&gt;Please find the report below.&lt;/p&gt;&#13;
				&lt;p style="text-align:left;"&gt;Total number of record picked :&lt;xsl:value-of select="$documentCount"/&gt;&lt;/p&gt;&#13;
			&lt;p/&gt;&#13;
			&lt;p/&gt;&#13;
			&lt;table border="1" align="left"&gt;&#13;
				&lt;tr bgcolor="#3498DB"&gt;&#13;
					&lt;th&gt;MESSAGE ID&lt;/th&gt;&#13;
					&lt;th&gt;MESSAGE&lt;/th&gt;&#13;
					&lt;th&gt;ACTION&lt;/th&gt;&#13;
					&lt;th&gt;BIZ STEP&lt;/th&gt;&#13;
					&lt;th&gt;DISPOSITION&lt;/th&gt;&#13;
					&lt;th&gt;READ POINT ID&lt;/th&gt;&#13;
					&lt;th&gt;BIZ LOCATION ID&lt;/th&gt;&#13;
					&lt;th&gt;BIZ TRANSACTION TYPE&lt;/th&gt;&#13;
					&lt;th&gt;BIZ TRANSACTION ID&lt;/th&gt;&#13;
					&lt;th&gt;STOCK OWNER&lt;/th&gt;&#13;
					&lt;th&gt;STOCK OWNER ID&lt;/th&gt;&#13;
					&lt;th&gt;SOLD ENTITY&lt;/th&gt;&#13;
					&lt;th&gt;SOLD ENTIYT ID&lt;/th&gt;&#13;
					&lt;th&gt;DESTINATION&lt;/th&gt;&#13;
					&lt;th&gt;DESTINATION ID&lt;/th&gt;&#13;
					&lt;th&gt;STATUS&lt;/th&gt;&#13;
					&lt;th&gt;SUBMITTED&lt;/th&gt;&#13;
					&lt;th&gt;TIME STAMP&lt;/th&gt;&#13;
					&lt;th&gt;RECORD ID&lt;/th&gt;&#13;
				&lt;/tr&gt;&#13;
				&lt;xsl:for-each select="businessLogs/logs/businessLog"&gt;&#13;
					&lt;xsl:sort select="message"/&gt;&#13;
					&lt;xsl:variable name="status"&gt;&#13;
						&lt;xsl:value-of select="status/text()"/&gt;&#13;
					&lt;/xsl:variable&gt;&#13;
					&lt;xsl:choose&gt;&#13;
						&lt;xsl:when test="$status ='Fail' "&gt;&#13;
							&lt;tr bgcolor="#F1948A"&gt;&gt;&#13;
								&lt;td&gt;&#13;
									&lt;xsl:value-of select="messageId"/&gt;&#13;
								&lt;/td&gt;&#13;
								&lt;td&gt;&#13;
									&lt;xsl:value-of select="message"/&gt;&#13;
								&lt;/td&gt;&#13;
								&lt;td&gt;&#13;
									&lt;xsl:value-of select="action"/&gt;&#13;
								&lt;/td&gt;&#13;
								&lt;td&gt;&#13;
									&lt;xsl:value-of select="bizStep"/&gt;&#13;
								&lt;/td&gt;&#13;
								&lt;td&gt;&#13;
									&lt;xsl:value-of select="disposition"/&gt;&#13;
								&lt;/td&gt;&#13;
								&lt;td&gt;&#13;
									&lt;xsl:value-of select="readPointId"/&gt;&#13;
								&lt;/td&gt;&#13;
								&lt;td&gt;&#13;
									&lt;xsl:value-of select="bizLocationId"/&gt;&#13;
								&lt;/td&gt;&#13;
								&lt;td&gt;&#13;
									&lt;xsl:value-of select="bizTransactionType"/&gt;&#13;
								&lt;/td&gt;&#13;
								&lt;td&gt;&#13;
									&lt;xsl:value-of select="bizTransactionId"/&gt;&#13;
								&lt;/td&gt;&#13;
								&lt;td&gt;&#13;
									&lt;xsl:value-of select="StockOwner"/&gt;&#13;
								&lt;/td&gt;&#13;
								&lt;td&gt;&#13;
									&lt;xsl:value-of select="StockOwnerId"/&gt;&#13;
								&lt;/td&gt;&#13;
								&lt;td&gt;&#13;
									&lt;xsl:value-of select="SoldEntity"/&gt;&#13;
								&lt;/td&gt;&#13;
								&lt;td&gt;&#13;
									&lt;xsl:value-of select="SoldEntityId"/&gt;&#13;
								&lt;/td&gt;&#13;
								&lt;td&gt;&#13;
									&lt;xsl:value-of select="Destination"/&gt;&#13;
								&lt;/td&gt;&#13;
								&lt;td&gt;&#13;
									&lt;xsl:value-of select="DestinationId"/&gt;&#13;
								&lt;/td&gt;&#13;
								&lt;td&gt;&#13;
									&lt;xsl:value-of select="status"/&gt;&#13;
								&lt;/td&gt;&#13;
								&lt;td&gt;&#13;
									&lt;xsl:value-of select="submitted"/&gt;&#13;
								&lt;/td&gt;&#13;
								&lt;td&gt;&#13;
									&lt;xsl:value-of select="timestamp"/&gt;&#13;
								&lt;/td&gt;&#13;
								&lt;td&gt;&#13;
									&lt;xsl:value-of select="_id"/&gt;&#13;
								&lt;/td&gt;&#13;
							&lt;/tr&gt;&#13;
						&lt;/xsl:when&gt;&#13;
						&lt;xsl:otherwise&gt;&#13;
							&lt;tr&gt;&#13;
								&lt;td&gt;&#13;
									&lt;xsl:value-of select="messageId"/&gt;&#13;
								&lt;/td&gt;&#13;
								&lt;td&gt;&#13;
									&lt;xsl:value-of select="message"/&gt;&#13;
								&lt;/td&gt;&#13;
								&lt;td&gt;&#13;
									&lt;xsl:value-of select="action"/&gt;&#13;
								&lt;/td&gt;&#13;
								&lt;td&gt;&#13;
									&lt;xsl:value-of select="bizStep"/&gt;&#13;
								&lt;/td&gt;&#13;
								&lt;td&gt;&#13;
									&lt;xsl:value-of select="disposition"/&gt;&#13;
								&lt;/td&gt;&#13;
								&lt;td&gt;&#13;
									&lt;xsl:value-of select="readPointId"/&gt;&#13;
								&lt;/td&gt;&#13;
								&lt;td&gt;&#13;
									&lt;xsl:value-of select="bizLocationId"/&gt;&#13;
								&lt;/td&gt;&#13;
								&lt;td&gt;&#13;
									&lt;xsl:value-of select="bizTransactionType"/&gt;&#13;
								&lt;/td&gt;&#13;
								&lt;td&gt;&#13;
									&lt;xsl:value-of select="bizTransactionId"/&gt;&#13;
								&lt;/td&gt;&#13;
								&lt;td&gt;&#13;
									&lt;xsl:value-of select="StockOwner"/&gt;&#13;
								&lt;/td&gt;&#13;
								&lt;td&gt;&#13;
									&lt;xsl:value-of select="StockOwnerId"/&gt;&#13;
								&lt;/td&gt;&#13;
								&lt;td&gt;&#13;
									&lt;xsl:value-of select="SoldEntity"/&gt;&#13;
								&lt;/td&gt;&#13;
								&lt;td&gt;&#13;
									&lt;xsl:value-of select="SoldEntityId"/&gt;&#13;
								&lt;/td&gt;&#13;
								&lt;td&gt;&#13;
									&lt;xsl:value-of select="Destination"/&gt;&#13;
								&lt;/td&gt;&#13;
								&lt;td&gt;&#13;
									&lt;xsl:value-of select="DestinationId"/&gt;&#13;
								&lt;/td&gt;&#13;
								&lt;td&gt;&#13;
									&lt;xsl:value-of select="status"/&gt;&#13;
								&lt;/td&gt;&#13;
								&lt;td&gt;&#13;
									&lt;xsl:value-of select="submitted"/&gt;&#13;
								&lt;/td&gt;&#13;
								&lt;td&gt;&#13;
									&lt;xsl:value-of select="timestamp"/&gt;&#13;
								&lt;/td&gt;&#13;
								&lt;td&gt;&#13;
									&lt;xsl:value-of select="_id"/&gt;&#13;
								&lt;/td&gt;&#13;
							&lt;/tr&gt;&#13;
						&lt;/xsl:otherwise&gt;&#13;
					&lt;/xsl:choose&gt;&#13;
				&lt;/xsl:for-each&gt;&#13;
			&lt;/table&gt;&#13;
		&lt;/body&gt;&#13;
	&lt;/html&gt;&#13;
&lt;/xsl:template&gt;&#13;
&lt;/xsl:stylesheet&gt;</stylesheet>
    </Xslt>
  </bns:object>
</bns:Component>
